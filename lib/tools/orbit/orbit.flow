// Produced by  flowcpp mango/mango.flow -- file=orbit.mango compile=1 main=orbit_compiled linter=1
import tools/mango/mcode_lib;
import string;
import net/url_parameter;
import tools/orbit/orbit_compiled_parser;
import tools/orbit/orbit_types;

main() {
	files = filtermap(getAllUrlParametersArray(), \a -> if (a[1] == "") Some(a[0]) else None());
	if (files == []) {
		println("Usage: orbit_linter <file>");
	}
	errors = sum(map(files, \f -> {
		program = getFileContent(f);

		res : Pair<OrRewriteSystem, string> = parseCompiledMango(f, program, orbit_parse_orbit_compiled, flow(0));
		if (res.second != "") {
			println(f + ": " + res.second);
			1
		} else 0;
	}));
	quit(errors);
}

