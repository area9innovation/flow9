// Produced by  flowcpp gringo/gringo.flow -- file=formats/html/gringo_parser/html.gringo compile=1
import text/gringo/dcode_lib;
import string;

export {
	parse_source(acc : DParseAcc<?>) -> bool;
}


parse_source(acc : DParseAcc<?>) -> bool {
	{
		pushDCheckpoint(acc);
		addVerbatim(acc, "nil");
		parseStar(acc, \ -> {
			{
				pushDCheckpoint(acc);
				if (parse_node(acc)) {
					{
						addVerbatim(acc, "cons");
						discardDCheckpoint(acc)
					}
				} else {
					restoreDCheckpoint(acc)
				}
			}
		});
		addVerbatim(acc, "source_1");
		discardDCheckpoint(acc)
	}
}

parse_node(acc : DParseAcc<?>) -> bool {
	{
		pushDCheckpoint(acc);
		if (parse_entity(acc) || (parse_tag(acc) || (parse_comment(acc) || parse_text(acc)))) {
			discardDCheckpoint(acc)
		} else {
			restoreDCheckpoint(acc)
		}
	}
}

parse_text(acc : DParseAcc<?>) -> bool {
	{
		pushDCheckpoint(acc);
		acc.starti ::= acc.i;
		pushDCheckpoint(acc);
		pushDCheckpoint(acc);
		pushDCheckpoint(acc);
		pushDCheckpoint(acc);
		if (if (if (((if (if (if (matchString(acc, "<")) {
			{
				pushDCheckpoint(acc);
				if (if (parse_letter(acc)) {
					discardDCheckpoint(acc)
				} else {
					{
						pushDCheckpoint(acc);
						if ((if ((matchString(acc, "/") && parse_letter(acc))) {
							discardDCheckpoint(acc)
						} else {
							restoreDCheckpoint(acc)
						}) || matchString(acc, "!--")) {
							discardDCheckpoint(acc)
						} else {
							restoreDCheckpoint(acc)
						}
					}
				}) {
					discardDCheckpoint(acc)
				} else {
					restoreDCheckpoint(acc)
				}
			}
		} else {
			restoreDCheckpoint(acc)
		}) {
			discardDCheckpoint(acc)
		} else {
			{
				pushDCheckpoint(acc);
				if (if (matchString(acc, "&")) {
					{
						pushDCheckpoint(acc);
						if (if (parse_s(acc)) {
							restoreDCheckpoint(acc)
						} else {
							{
								restoreDCheckpoint(acc);
								true
							}
						}) {
							discardDCheckpoint(acc)
						} else {
							restoreDCheckpoint(acc)
						}
					}
				} else {
					restoreDCheckpoint(acc)
				}) {
					discardDCheckpoint(acc)
				} else {
					restoreDCheckpoint(acc)
				}
			}
		}) {
			restoreDCheckpoint(acc)
		} else {
			{
				restoreDCheckpoint(acc);
				true
			}
		}) && parse_any(acc))) {
			{
				parseStar(acc, \ -> {
					{
						pushDCheckpoint(acc);
						pushDCheckpoint(acc);
						pushDCheckpoint(acc);
						pushDCheckpoint(acc);
						if (((if (if (if (matchString(acc, "<")) {
							{
								pushDCheckpoint(acc);
								if (if (parse_letter(acc)) {
									discardDCheckpoint(acc)
								} else {
									{
										pushDCheckpoint(acc);
										if ((if ((matchString(acc, "/") && parse_letter(acc))) {
											discardDCheckpoint(acc)
										} else {
											restoreDCheckpoint(acc)
										}) || matchString(acc, "!--")) {
											discardDCheckpoint(acc)
										} else {
											restoreDCheckpoint(acc)
										}
									}
								}) {
									discardDCheckpoint(acc)
								} else {
									restoreDCheckpoint(acc)
								}
							}
						} else {
							restoreDCheckpoint(acc)
						}) {
							discardDCheckpoint(acc)
						} else {
							{
								pushDCheckpoint(acc);
								if (if (matchString(acc, "&")) {
									{
										pushDCheckpoint(acc);
										if (if (parse_s(acc)) {
											restoreDCheckpoint(acc)
										} else {
											{
												restoreDCheckpoint(acc);
												true
											}
										}) {
											discardDCheckpoint(acc)
										} else {
											restoreDCheckpoint(acc)
										}
									}
								} else {
									restoreDCheckpoint(acc)
								}) {
									discardDCheckpoint(acc)
								} else {
									restoreDCheckpoint(acc)
								}
							}
						}) {
							restoreDCheckpoint(acc)
						} else {
							{
								restoreDCheckpoint(acc);
								true
							}
						}) && parse_any(acc))) {
							discardDCheckpoint(acc)
						} else {
							restoreDCheckpoint(acc)
						}
					}
				});
				discardDCheckpoint(acc)
			}
		} else {
			restoreDCheckpoint(acc)
		}) {
			addMatched(acc, substring(acc.input, acc.starti, acc.i - acc.starti))
		} else {
			false
		}) {
			{
				addVerbatim(acc, "text_1");
				discardDCheckpoint(acc)
			}
		} else {
			restoreDCheckpoint(acc)
		}
	}
}

parse_comment(acc : DParseAcc<?>) -> bool {
	{
		pushDCheckpoint(acc);
		if (matchString(acc, "<!--")) {
			{
				acc.starti ::= acc.i;
				parseStar(acc, \ -> {
					{
						pushDCheckpoint(acc);
						pushDCheckpoint(acc);
						if (((if (matchString(acc, "-->")) {
							restoreDCheckpoint(acc)
						} else {
							{
								restoreDCheckpoint(acc);
								true
							}
						}) && parse_any(acc))) {
							discardDCheckpoint(acc)
						} else {
							restoreDCheckpoint(acc)
						}
					}
				});
				addMatched(acc, substring(acc.input, acc.starti, acc.i - acc.starti));
				if (matchString(acc, "-->")) {
					{
						addVerbatim(acc, "comment_1");
						discardDCheckpoint(acc)
					}
				} else {
					restoreDCheckpoint(acc)
				}
			}
		} else {
			restoreDCheckpoint(acc)
		}
	}
}

parse_entity(acc : DParseAcc<?>) -> bool {
	{
		pushDCheckpoint(acc);
		acc.starti ::= acc.i;
		if (if (matchString(acc, "&#x") || (matchString(acc, "&#") || matchString(acc, "&"))) {
			addMatched(acc, substring(acc.input, acc.starti, acc.i - acc.starti))
		} else {
			false
		}) {
			{
				acc.starti ::= acc.i;
				pushDCheckpoint(acc);
				pushDCheckpoint(acc);
				if (if (if (if (parse_hex_digit(acc) || parse_letter(acc)) {
					discardDCheckpoint(acc)
				} else {
					restoreDCheckpoint(acc)
				}) {
					{
						parseStar(acc, \ -> {
							{
								pushDCheckpoint(acc);
								if (parse_hex_digit(acc) || parse_letter(acc)) {
									discardDCheckpoint(acc)
								} else {
									restoreDCheckpoint(acc)
								}
							}
						});
						discardDCheckpoint(acc)
					}
				} else {
					restoreDCheckpoint(acc)
				}) {
					addMatched(acc, substring(acc.input, acc.starti, acc.i - acc.starti))
				} else {
					false
				}) {
					{
						pushDCheckpoint(acc);
						pushDCheckpoint(acc);
						if (if ((parse_ws(acc) && matchString(acc, ";"))) {
							discardDCheckpoint(acc)
						} else {
							restoreDCheckpoint(acc)
						}) {
							discardDCheckpoint(acc)
						} else {
							restoreDCheckpoint(acc)
						};
						addVerbatim(acc, "entity_2");
						discardDCheckpoint(acc)
					}
				} else {
					restoreDCheckpoint(acc)
				}
			}
		} else {
			restoreDCheckpoint(acc)
		}
	}
}

parse_tag(acc : DParseAcc<?>) -> bool {
	{
		pushDCheckpoint(acc);
		acc.starti ::= acc.i;
		if (((if (matchString(acc, "</") || matchString(acc, "<")) {
			addMatched(acc, substring(acc.input, acc.starti, acc.i - acc.starti))
		} else {
			false
		}) && ((parse_ws(acc) && ((parse_id(acc) && parse_ws(acc))))))) {
			{
				addVerbatim(acc, "nil");
				parseStar(acc, \ -> {
					{
						pushDCheckpoint(acc);
						if (parse_attrib(acc)) {
							{
								addVerbatim(acc, "cons");
								discardDCheckpoint(acc)
							}
						} else {
							restoreDCheckpoint(acc)
						}
					}
				});
				acc.starti ::= acc.i;
				if (if (matchString(acc, "/>") || matchString(acc, ">")) {
					addMatched(acc, substring(acc.input, acc.starti, acc.i - acc.starti))
				} else {
					false
				}) {
					{
						addVerbatim(acc, "tag_4");
						discardDCheckpoint(acc)
					}
				} else {
					restoreDCheckpoint(acc)
				}
			}
		} else {
			restoreDCheckpoint(acc)
		}
	}
}

parse_attrib(acc : DParseAcc<?>) -> bool {
	{
		pushDCheckpoint(acc);
		if ((parse_id(acc) && ((parse_ws(acc) && ((parse_val(acc) && parse_ws(acc))))))) {
			{
				addVerbatim(acc, "attrib_2");
				discardDCheckpoint(acc)
			}
		} else {
			restoreDCheckpoint(acc)
		}
	}
}

parse_val(acc : DParseAcc<?>) -> bool {
	{
		pushDCheckpoint(acc);
		pushDCheckpoint(acc);
		if (if ((matchString(acc, "=") && parse_ws(acc))) {
			{
				pushDCheckpoint(acc);
				pushDCheckpoint(acc);
				if (if (if (matchString(acc, "'")) {
					{
						acc.starti ::= acc.i;
						parseStar(acc, \ -> {
							{
								pushDCheckpoint(acc);
								pushDCheckpoint(acc);
								if (((if (matchString(acc, "'")) {
									restoreDCheckpoint(acc)
								} else {
									{
										restoreDCheckpoint(acc);
										true
									}
								}) && parse_any(acc))) {
									discardDCheckpoint(acc)
								} else {
									restoreDCheckpoint(acc)
								}
							}
						});
						addMatched(acc, substring(acc.input, acc.starti, acc.i - acc.starti));
						if (matchString(acc, "'")) {
							discardDCheckpoint(acc)
						} else {
							restoreDCheckpoint(acc)
						}
					}
				} else {
					restoreDCheckpoint(acc)
				}) {
					discardDCheckpoint(acc)
				} else {
					{
						pushDCheckpoint(acc);
						if (if (matchString(acc, "\"")) {
							{
								acc.starti ::= acc.i;
								parseStar(acc, \ -> {
									{
										pushDCheckpoint(acc);
										pushDCheckpoint(acc);
										if (((if (matchString(acc, "\"")) {
											restoreDCheckpoint(acc)
										} else {
											{
												restoreDCheckpoint(acc);
												true
											}
										}) && parse_any(acc))) {
											discardDCheckpoint(acc)
										} else {
											restoreDCheckpoint(acc)
										}
									}
								});
								addMatched(acc, substring(acc.input, acc.starti, acc.i - acc.starti));
								if (matchString(acc, "\"")) {
									discardDCheckpoint(acc)
								} else {
									restoreDCheckpoint(acc)
								}
							}
						} else {
							restoreDCheckpoint(acc)
						}) {
							discardDCheckpoint(acc)
						} else {
							{
								acc.starti ::= acc.i;
								pushDCheckpoint(acc);
								pushDCheckpoint(acc);
								if (if (if (if (parse_letter(acc) || (parse_dec_digit(acc) || (matchString(acc, "_") || matchString(acc, "-")))) {
									discardDCheckpoint(acc)
								} else {
									restoreDCheckpoint(acc)
								}) {
									{
										parseStar(acc, \ -> {
											{
												pushDCheckpoint(acc);
												if (parse_letter(acc) || (parse_dec_digit(acc) || (matchString(acc, "_") || matchString(acc, "-")))) {
													discardDCheckpoint(acc)
												} else {
													restoreDCheckpoint(acc)
												}
											}
										});
										discardDCheckpoint(acc)
									}
								} else {
									restoreDCheckpoint(acc)
								}) {
									addMatched(acc, substring(acc.input, acc.starti, acc.i - acc.starti))
								} else {
									false
								}) {
									discardDCheckpoint(acc)
								} else {
									restoreDCheckpoint(acc)
								}
							}
						}
					}
				}) {
					discardDCheckpoint(acc)
				} else {
					restoreDCheckpoint(acc)
				}
			}
		} else {
			restoreDCheckpoint(acc)
		}) {
			discardDCheckpoint(acc)
		} else {
			{
				addMatched(acc, "1");
				discardDCheckpoint(acc)
			}
		}
	}
}

parse_dec_digit(acc : DParseAcc<?>) -> bool {
	matchRange(acc, 48, 57)
}

parse_hex_digit(acc : DParseAcc<?>) -> bool {
	{
		pushDCheckpoint(acc);
		if (parse_dec_digit(acc) || (matchRange(acc, 65, 70) || matchRange(acc, 97, 102))) {
			discardDCheckpoint(acc)
		} else {
			restoreDCheckpoint(acc)
		}
	}
}

parse_letter(acc : DParseAcc<?>) -> bool {
	matchRange(acc, 97, 122) || matchRange(acc, 65, 90)
}

parse_id(acc : DParseAcc<?>) -> bool {
	{
		acc.starti ::= acc.i;
		pushDCheckpoint(acc);
		if (if (parse_letter(acc)) {
			{
				parseStar(acc, \ -> {
					{
						pushDCheckpoint(acc);
						if (parse_letter(acc) || parse_dec_digit(acc)) {
							discardDCheckpoint(acc)
						} else {
							restoreDCheckpoint(acc)
						}
					}
				});
				discardDCheckpoint(acc)
			}
		} else {
			restoreDCheckpoint(acc)
		}) {
			addMatched(acc, substring(acc.input, acc.starti, acc.i - acc.starti))
		} else {
			false
		}
	}
}

parse_s(acc : DParseAcc<?>) -> bool {
	{
		pushDCheckpoint(acc);
		if (parse_ws_(acc)) {
			{
				parseStar(acc, \ -> {
					parse_ws_(acc)
				});
				discardDCheckpoint(acc)
			}
		} else {
			restoreDCheckpoint(acc)
		}
	}
}

parse_ws(acc : DParseAcc<?>) -> bool {
	parseStar(acc, \ -> {
		parse_ws_(acc)
	})
}

parse_ws_(acc : DParseAcc<?>) -> bool {
	matchString(acc, " ") || (matchString(acc, "\t") || (matchString(acc, "\n") || matchString(acc, "\u000d")))
}

parse_any(acc : DParseAcc<?>) -> bool {
	matchRange(acc, 0, 65535)
}

















