import material/material2tropic;
import material/material_dialog;

main() {
	manager = makeMaterialManager([]);

	def = ["afsdfdsf", "asdfasdfasdf", "asdfdasfdsfasd"];
	data = make(def);

	add = \ -> dynArrayPush(data, "new text");
	del = \ -> nextDistinct(data, take(getValue(data), length(getValue(data)) - 1));
	reset = \ -> nextDistinct(data, def);

	elText = "veeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeery looooooong text";
	el = MTooltip(MEllipsisText(elText, []), MText("TOOLTIP", []), []);

	dContent =
		MDynamicDataTable(
			[
				MColumn("col1", "", 200, [MAutoSort()/*, RightAlign()*/]),
				MColumn("col2", "", 200, []),
				MColumn("col3", "", 100, []),
				MColumn("col4", "", 100, []),
				MColumn("col5", "", 100, []),
			],
			fselect(data, FLift(\d -> mapi(d, \i, v -> [MText("line " + i2s(i /*floor(100. * random())*/), []), MText(v, []), MText(v, []), MText("some text", []), MText("another text", [])]))),
			// const([[MText("1", [])]]),
			[
				// MDataTableInnerScroll(MGluedFirstColumnMode()),
				// MDataTableInnerScroll(MLiftedFirstColumnMode()),
				// MDataTableInnerScroll(MStandardMode()),
				// TScrollEnabled(const(true)),
				MPaginationAutoScaling(),
				MHideAutoPaginationFooter(),
				// MPagination(make(0), [5]),
				MHeaderActions(MTextButton("ACTION", nop, [], []) |> MAlignRight, []),
				// MFixedRow(
				// 	const(true),
				// 	[MEllipsisText("1111", []), MFixed(800., 20.), MEllipsisText("1111", [])],
				// 	[]
				// ),
				// MCondensed(true),
				// MWidthByContent(),
				// MInCard(),
				// MFullWidth(),

				// MExpandRow(const(true)),
				
				// // MListSelection(const(true), true, false, make([])),
				// MCheckBoxSelection([]),
				// MMultiSelection(make(makeSet())),
				// MRowHeight(100.),
				// MHeaderRowHeight(56.),
				// // TScrollEnabled(const(true))
				// MNoCrop(),
				// MShowRowNumbers(),
				// // MListSelectionEnabled(const([const(false), const(true), const(false)]))
				// MListSelectionEnabled(fselect(data, FLift(\d -> mapi(d, \i, __ -> const(i % 2 == 0)))))

				// MNoSeparators()
			]
		)
		// |> (\m -> MDebugMetrics(orange, m))
		// |> (\m -> MScroll(m, TFillXY(), []))
		// |> (\m -> MLines2(MText("text", []), m))
		;

	// dialogContentB = make(TEmpty());

	// showDialog = \ -> {
	// 	ShowMDialog(manager, make(false), [
	// 		MDialogTitle(_("Deploy selected packages")),
	// 		MDialogUseFrame(),
	// 		MDialogScroll(),
	// 		MDialogActions([
	// 			MTextButton(_("CANCEL"), nop, [], []),
	// 			MTextButton(_("CANCEL"), nop, [], []),
	// 			MTextButton(_("CANCEL"), nop, [], []),
	// 		])
	// 	], dContent /* MMutable(dialogContentB)*/);

	// 	// timer(3000, \ -> nextDistinct(dialogContentB, dContent))
	// };

	content =
		MLines([
			// MTextButton("DIALOG", showDialog, [], []),
			dContent,
			MTextButton("ADD", add, [], []),
			MTextButton("DELETE LAST", del, [], []),
			// MTextButton("RESET", reset, [], []),
		]);
	
	mrender(manager, true, content);
}