import material/material2tropic;

main() {
	manager = makeMaterialManager([]);
	setRendererType("html");

	text = make("");
	fpprint("~~text")(text);

	content =
		MAutoComplete(text, [], [
			MAutoCompleteStartSearch(0, 300),
			// MAutoCompleteShowMoreButton(),
			MAutoCompleteAsync(fakeRequest)
		], []);

	mrender(manager, true, content) |> ignore;
}

counter = ref 0;
fakeRequest(txt : string, onResponse : ([string]) -> void) -> void {
	if (txt == "") onResponse([])
	else {
		println("REQUEST based on '" + txt + "'");
		timer(2000, \ -> {
			itms = generate(^counter, ^counter + 10, \i -> "text " + i2s(i));
			counter := ^counter + 10;
			println("RESPONSE for '" + txt + "'");
			onResponse(itms);
		})
	}
}
