import material/material2tropic;

main() {
	manager = makeMaterialManager([]);

	expander = make(false);
	rExp = make(false);

	content =
		MLines([
			MText("CONTENT", []),
			MTextButton("RIGHT", \ -> reverseBehaviour(rExp), [], []),
			TRectangle([GradientFill(90.0, [GradientPoint(blue, 1.0, 0.0), GradientPoint(yellow, 1.0, 1.0),])], TFixed(100., 1000.)),
			TRectangle([MFill(MBlack())], TFixed(20., 20.))
		]);

	toolbar = MToolbar(
		expander,
		MText("TEXT", []),
		[],
		[]
	);

	lnavBarContent =
		// TFixed(20., 20.)
		// TFillWY(200.)
		// |> addTBackground(MGreen(200));
		MSideNav(
			MSNSmallHead([
				MText("HEAD", [])
			]),
			// MSNCardHead(
			// 	"http://build.area9innovation.com/material/head_background.jpg",
			// 	MSNHeadPhoto(const("http://api.adorable.io/avatars/72/eott@adorable.io.png"), nop),
			//  	[
			//  		MSNHeadPhoto(const("http://api.adorable.io/avatars/72/rott@adorable.io.png"), nop),
			//  		MSNHeadPhoto(const("http://api.adorable.io/avatars/72/tott@adorable.io.png"), nop),
			//  	],
			// 	const("Jonathan Lee"),
			// 	const("heyfromjonathan@gmail.com")
			// ),
			TFixed(20., 20.)
			|> addTBackground(MGreen(200)),
			expander,
			[]
		);


	lnavBar = MLeftNav(
		lnavBarContent,
		expander,
		[/*MSideNavMini()*/  /*MSideNavPersistent(const(true))*/]
	);

	rnavBar = MRightNav(
		// TFillWY(200.)
		// |> addTBackground(MGreen(200)),

		generate(0, 40, \i -> MText(i2s(i), []))
		|> MLines
		|> (\m -> MScroll(m, TFillWY(150.), [])),

		rExp,

		[/*MSideNavMini(),*/ /*MSideNavPersistent(const(true))*/ /*, MSideNavWidth(150.0)*/]
	);

	// rnavBar =
	// 	MRightNav(
	// 		// MAvailable(
	// 			TFillWY(200.)
	// 			|> addTBackground(MGreen(200)),
	// 			// TFillWY(200.0)
	// 		// ),
	// 		rExp,
	// 		[/*MSideNavWidth(150.0),*/ MSideNavPersistent(const(true))]
	// 	);

	bottomWidth = make(0.);
	// fpprint("width : ")(bottomWidth);

	bottom = \expanded ->
		TFillXY()
		// TFillXH(1024.)
		// TFillXH(560.)
		// TFillXH(16.)
		// TFillXH(64.)
		// |> (\t -> TAttachWidth(t, bottomWidth))
		// |> addTBackground(MGreen(200))
		|> (\t -> TRectangle([GradientFill(90.0, [GradientPoint(green, 1.0, 0.0), GradientPoint(purple, 1.0, 1.0),])], t))
		|> (\t -> MGroup2(
				t,
				MDynamicText(
					fselect(expanded, FLift(\e -> "TEST TEXT " + if (e) "expanded" else "collapsed")),
					[]
				)
			)
		);

	app = MAppStructure([
			MContent(content),
			MAppBar(toolbar),
			lnavBar,
			rnavBar,
			MBottomSheet(bottom, [
				// MCollapsedHeight(const(500.))
				MSwipeGap(50.)
			])
		], [
			// MFloatingToolbar(),
			// MExtendedAppBar([]),
			// MNoContentBorder(),
			// MAppStructureFlexible([]),
			// MNoScroll()
		]);
	
	mrender(manager, true, app);
}