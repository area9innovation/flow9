import material/material_ui;

main () {
	text = make("");
	fpprint("text")(text);

	view = MDropDownOrAutoComplete([], make(-1), [
		MItemsLimit(-1),
		MInputInspector(text),
		MItemOnSelect(\s -> println("ON SELECT : " + s)),
		MAutoCompleteStyles([
			MWidth(540.0),
			MAutoCompleteAsync(fakeRequest)
		]),
		MHideBrowseButton()
	]);

	mrender(makeMaterialManager([]), true, view);
}

counter = ref 0;
fakeRequest(txt : string, onResponse : ([string]) -> void) -> void {
	if (txt == "") onResponse([])
	else {
		println("REQUEST based on '" + txt + "'");
		timer(2000, \ -> {
			itms = generate(^counter, ^counter + 10, \i -> "text " + i2s(i));
			counter := ^counter + 10;
			println("RESPONSE for '" + txt + "'");
			onResponse(itms);
		})
	}
}