import material/material2tropic;
import material/form2material;
import material/material_dialog;

main() {
	setRendererType("html");
	manager = makeMaterialManager([]);

	availBox = makeWH();
	size = makeWH();

	boxSize = const(WidthHeight(532., 400.)); // Reproduces with static width

	content =
		drawPrimeBackgroundMedia(
			"http://frugalfrolicker.com/wp-content/uploads/2015/07/Kangaroo-Valley-10.jpg",
			boxSize
		)
		|> (\m -> MAttachBox(m, size))
		|> (\m -> MCropSize(TSized(boxSize), m))
		|> (\m -> MScale(ffactor2(const(0.8)), m))
		|> (\m -> MGroup2(m, MLines2(
				MSelect(size, \sz -> MText("Size : " + d2s(sz.width) + " x " + d2s(sz.height), [])),
				MSelect(availBox, \sz -> MText("Available : " + d2s(sz.width) + " x " + d2s(sz.height), []))
			)))
		|> (\m -> MAttachAvailable(m, availBox))
		|> (\m -> MLines2(m, MBorder4(8., MIconButton("android", nop, [MIconSize(40.)], []))));

	mrender(manager, true, content);
}

drawPrimeBackgroundMedia(url : string, bgSizeT : Transform<WidthHeight>) -> Material {
	pictBgGraphicStyle = [
		GradientFill(0.0, [GradientPoint(16777215, 0.3, 0.0), GradientPoint(16777215, 1.0, 1.0)]),
		// UseSvg()
	];
	
	MGroup([
		MPicture(
			url,
			[
				MPictureShowLoading(false),
			]
		),
		TRectangle(pictBgGraphicStyle, TSized(bgSizeT))
	])
}