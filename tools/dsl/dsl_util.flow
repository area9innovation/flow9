import tools/dsl/dsl_ast;

export {
	getDslBool(a : DslAst) -> bool;
	getDslInt(a : DslAst) -> int;
	getDslString(a : DslAst) -> string;
	getDslNode(a : DslAst) -> DslNode;
	getDslList(a : DslAst) -> List<DslAst>;
}

getDslBool(a : DslAst) -> bool {
	switch (a) {
		DslBool(v): v;
		default: false;
	}
}

getDslInt(a : DslAst) -> int {
	switch (a) {
		DslInt(v): v;
		default: 0;
	}	
}

getDslString(a : DslAst) -> string {
	switch (a) {
		DslString(s): s;
		default: "";
	}
}

getDslNode(a : DslAst) -> DslNode {
	switch (a) {
		DslNode(v, args, pos): a;
		default: DslNode("", [a], 0);
	}
}


getDslList(a : DslAst) -> List<DslAst> {
	switch (a) {
		DslList(v): v;
		default: makeList1(a);
	}
}
