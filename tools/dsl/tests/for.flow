import tools/dsl/registry/dsl_populate;

main() {
	folders = filter(["languages", "tools/dsl/languages"], isDirectory);
	populateDsls(folders[0]);

	println(prettyDsl(evalDslProgram(makeDslEnv(), "lambda+array+for", << {
		for x in cons(2, cons(3, nil())) println(x * 2);
		"end"
	}>>)));

	//This variant with array doesn't work. TODO: fix it.
	println(prettyDsl(evalDslProgram(makeDslEnv(), "lambda+array+for", << {
		for x in [1, 2, 3] println(x * 2);
		"end"
	}>>)));

	//This variant with language definition transposed doesn't work. TODO: fix it.
	println(prettyDsl(evalDslProgram(makeDslEnv(), "lambda+for+array", << {
		for x in cons(2, cons(3, nil())) println(x * 2);
		"end"
	}>>)));

	println("Done");
	quit(0);
}
