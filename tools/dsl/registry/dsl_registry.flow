import tools/dsl/registry/dsl_transformation;

export {
	// Facility to register transformations for the language facility
	registerDslTransformation(d : DslTransformation) -> void;

	getDslTransformations(phase : string) -> [DslTransformation];
}

// Lookup from phase to transformations
dslTransformationsPhases : ref Tree<string, [DslTransformation]> = ref makeTree();

registerDslTransformation(d : DslTransformation) -> void {
	// println("Register '" + d.phase + "' for " + d.specification);
	dslTransformationsPhases := treePushToArrayValue(^dslTransformationsPhases, d.phase, d);
}

getDslTransformations(phase : string) -> [DslTransformation] {
	getTreeArrayValue(^dslTransformationsPhases, phase)
}
