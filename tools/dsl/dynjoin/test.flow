import tools/dsl/dynjoin/grammar;
import tools/dsl/dsl_eval;
import tools/dsl/dsl_runtime_common;

main() {
	grammar = defineDynJoin();
	program = parseProgram("test", grammar, <<
		fn = \~a, b -> a + b;
		fn(1, 2)
	>>);

	env0 = makeDslEnv();
	env = DslEnv(env0 with locals = addCommonDslRuntime([], env0.locals));

	println(prettyDsl(program));


	value = evaluateDsl(env, program);
	println(prettyDsl(value));
	quit(0);
}
