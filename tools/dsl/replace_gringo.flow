import text/gringo/gringo_ast;

export {
	// Replace the last term in a gringo grammar
	replaceLastGringo(term : GTerm, newLast : GTerm) -> GTerm;
}

replaceLastGringo(t : GTerm, newLast : GTerm) -> GTerm {
	rec = \tt -> replaceLastGringo(tt, newLast);
	switch (t) {
		GRule(id, term, body): GRule(id, term, rec(body));
		GPrecedence(left, right): GPrecedence(left, rec(right));
		GChoice(left, right): GChoice(left, rec(right));
		GSeq(left, right): GSeq(left, rec(right));
		GStar(term): newLast;
		GPlus(term): newLast;
		GOpt(term): newLast;
		GNegate(term): newLast;
		GError(term): newLast;
		GLower(term): newLast;
		GUnquote(term): newLast;
		GString(text): newLast;
		GRange(lower, upper): newLast;
		GVar(id): newLast;
		GEpsilon(): newLast;
	}
}
