import tools/dsl/dsl_parse;
import tools/dsl/dsl_lowering;
import tools/dsl/languages/ast_syntax;

export {
	// area(width = 100, height = 50) { width * height }
	//
	// area(width = 25)  should then be translated to area(25, 50)
	defineNamedCall(language : DslLanguage) -> DslLanguage;
}

defineNamedCall(language : DslLanguage) -> DslLanguage {
	namedCalls = extendGrammar(language.grammar, << 
		postfix = "(" ws funargs ")" ws $"named_call_2" | postfix;

		funargs = $"nil" funarg $"cons" ("," ws funarg $"cons")* ("," ws)? | $"nil";
		funarg = id "=" ws exp $"funarg_2" | id $"funarg_1";
	>>);

	DslLanguage("named-calls", namedCalls, None(), None(), None(),
		makeTree(),
		[], Some(language)
	);
}
