import tools/flowc/incremental/fiprogram;
import tools/flowc/statements/fs_exp;

export {
	// Mirrors FiModule, except we get rid of excessive stuff and keep it as tight as we can

	FsModule(
		fileinfo : FiFileInfo,
		imports: [FiImport], // unresolved paths to included modules
		exports: [string],   // names of unions, structs, functions, values, natives
		structs : [FiTypeStruct],
		unions : [FiTypeUnion],
		functions: [FsFunctionDec],
		globalVars: [FsGlobalVar],
		// Safe initialization order of global vars.
		initOrder : [string]
	);

	dummyFsModule = FsModule(dummyFiFileInfo, [], [], [], [], [], [], []);

	FsToplevel ::= FsDeclaration, FiStructOrUnion;
	FsDeclaration ::= FsFunctionDec, FsGlobalVar/*, FsNativeDec*/;

	FsFunctionDec(
		name: string,
		lambda: Maybe<FsLambda>, // None lambda means a native function
		type: FiTypeFunction,
		//info: FsFuncInfo
	);

	FsFuncInfo(
		//closure: [bool], // Which of closure variables are singletons
		argSingleton: [bool], // Which of argument variables are singletons
		returnSingleton: bool // is retrun a sigleton or not
	);

	FsGlobalVar(
		name: string,
		value: FsStat,
		type: FiType,
	);
}
