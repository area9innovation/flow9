import expect;
import dynamic;

// test runtime crash on converting idfn from flow -> flow to flow -> bool via boxing/unboxing

idfn(x) { x; }

buildfun(x : ?, res : ??) -> (?) -> (??) {
    flow(idfn);
}

buildfunSimple() -> (flow) -> (bool) {
    flow(idfn);
}

buildfunSimpleWorking() -> (flow) -> (bool) {
    flow(\p -> cast(flow(p) : flow -> bool));
}

test() {
    buildfunSimpleWorking();
    buildfunSimple();
	buildfun(flow(true), true);
}

main() {
	test();
}

