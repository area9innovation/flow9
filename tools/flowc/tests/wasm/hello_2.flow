// import ds/array;
import string;
// import math/math;

native prints : (string) -> void = host.prints;
native printi : (int) -> void = host.printi;

test() {
	browserOs = hostCall("getOs", []);

//	os = toString(browserOs);

	os = if (toString(browserOs) != "{}") {
		prints("true case");
		browserOs
	} else {
		"AAAAAAAA";
	}


		osParts = strSplit(os, ",");

		prints("initOsParts 3");
		majorOsPart = if (length(osParts) > 0 && osParts[0] != "") osParts[0] else "other";

		prints("initOsParts 4");
		minorOsPart = if (length(osParts) > 1 && osParts[1] != "") osParts[1] else "other";

		prints("initOsParts 5");
		isWindows = majorOsPart == "Windows";

		prints("initOsParts 6");

		userAgentCheck = hostCall("getUserAgent", []);
		userAgent = if (toString(userAgentCheck) != "{}") userAgentCheck else "other";

		isMacOSX = majorOsPart == "MacOSX" 
					|| strContains(toLowerCase(userAgent), "mac os x");  // [-Revise-] temporary fix for Firefox on Mac. Must be removed once we have correct majorOsPart
		isLinux = majorOsPart == "Linux";
		isIos = majorOsPart == "iOS";
		isAndroid = majorOsPart == "Android";

		flashCheck = hostCall("getVersion", []);
		flashVersion = if (toString(flashCheck) != "{}") flashCheck else "other";

		browserCheck = hostCall("getBrowser", []);
		browser = if (toString(browserCheck) != "{}") browserCheck else "other";

		resolutionCheck = hostCall("getResolution", []);
		resolution = if (toString(resolutionCheck) != "{}") resolutionCheck else "other";

	prints(os);
}




main() {
	prints("start");

	test();

	prints("end");
}
