// import net/http;
import ds/array;

native makeHttpRequest : io (
	url : string,
	postMethod : bool,
	headers : [[string]],
	params : [[string]],
	onData : (string) -> void,
	onError : (string) -> void,
	onStatus : (int) -> void,
) -> void = HttpSupport.httpRequest;
native println2 : io (flow) -> void = Native.println;
i2s(i) { cast(i : int -> string); }
native timer : io (int, () -> void) -> void = Native.timer;

main() {
	arr = enumFromTo(1, 200);
	
	makeHttpRequest(
		"https://dev.eu.rhapsode.com/oauth/utils/login.php",
		true,
		[],
		[["operation", "app"], ["password", "password"], ["login", "yulia.shkel@area9.dk"], ["app", "curator"], ["t", "1680092402788"], ["target", "js"]],
		\data -> timer(20, \-> println2("[DATA] :: " + data)),
		\error -> println2("[ERROR] :: " + error),
		\status -> println2("[STATUS] :: " + i2s(status))
	);
	iter(arr, \v -> timer(v+2, \-> println2(v)));
}