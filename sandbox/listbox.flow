import material/material;
import material/material_manager;
import material/material2tropic;

ListBox(array : [string], selectedIndex : DynamicBehaviour<int>) -> Material {
    MLinesA(mapi(array, \i, item -> {
        isSelected = feq(selectedIndex, i);
        
        MSelect(isSelected, \v -> {
            MTextButton(
                item, 
                \ -> { next(selectedIndex, i);}, 
                if(v){ [MOutlined()]; } else { [];}, 
                []);
            });
    }));
}


main() {
    
    manager = makeMaterialManager([]);
    selectedIndex = make(-1);

    list = [
        _("Apple"), _("Orange"), _("Lemon"), _("Pear"), _("Pinapple"), _("Cerry"), _("Strawberry"), 
        _("Plum"), _("Grapefruit"), _("Grape"), _("Melon"), _("Watermelon"), _("Pomegranate"), _("Dragonfruit")
    ];

    listbox = MAvailable(MScrollBox(ListBox(list, selectedIndex)), MFillWY(200.0));
    
    state = MAvailable(
                MSelect(
                    selectedIndex,
                    \index -> MLinesA([
                        MText(formatString(_("Selected Index = %1"), [i2s(index)]), []),
                        MText(formatString(_("Selected Value = %1"), [if(index >= 0 && index < length(list)) list[index] else ""]), []),
                        
                    ])), 
                MFillX());
                
    view = MColsA([listbox, state]);

    mrender(manager, true, view);
}