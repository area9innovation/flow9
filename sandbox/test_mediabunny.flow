import mediabunny;
import runtime;
import net/http;

main() {
	url = "./images/material_test/big_buck_bunny.mp4";

	makeFileByBlobUrl(url, "big_buck_bunny", \file -> {
		mbGetMediaDuration(file, \duration -> {
			println(duration)
		});

		mbConversion(file, MBAudioWAV(), [], \outputFile -> {
			saveNativeFileClient("output", outputFile)
		}, \err -> println("[ERROR] mbConversion WAV: " + err));

		mbConversion(file, MBAudioMP3(), [], \outputFile -> {
			saveNativeFileClient("output", outputFile)
		}, \err -> println("[ERROR] mbConversion MP3: " + err));

		mbConversion(file, MBVideoWEBM(), [], \outputFile -> {
			saveNativeFileClient("output", outputFile);
			mbConversion(file, MBVideoMP4(), [MBCrop(20, 50, 256, 128)], \outputFile1 -> {
			saveNativeFileClient("output", outputFile1);
		}, \err -> println("[ERROR] mbConversion MP4: " + err))
		}, \err -> println("[ERROR] mbConversion WEBM: " + err));
	}, \err -> println("[ERROR] makeFileByBlobUrl: " + err))

}