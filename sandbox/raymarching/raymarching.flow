import material/extra/raymarching/raymarching;

main() {
	setRendererType("html");

	spheres1 = RMTranslate(
		RMUnion2(
			RMMaterial(RMTranslate(RMSphere(1.), RMY(1.)), RMReflect(0xFFFF00, 0.5)),
			RMTranslate(
				RMUnion2(
					RMMaterial(RMTranslate(RMSphere(0.5), RMX(2.)), RMColor(0xFF00FF)),
					RMMaterial(RMTranslate(RMSphere(0.5), RMX(-2.)), RMColor(0x00FFFF))
				),
				RMYZ(2., 2.)
			)
		),
		RMZ(3.)
	);

	spheres2 = RMUnion2(
		RMMaterial(RMSphere(0.5), RMColor(0x00FF00)),
		RMUnion2(
			RMMaterial(RMTranslate(RMSphere(0.5), RMX(2.)), RMColor(0x0000FF)),
			RMMaterial(RMTranslate(RMSphere(0.5), RMX(-2.)), RMColor(0xFF0000))
		),
	);

	//scene = RMTranslate(RMUnion2(spheres1, spheres2), RMZ(3.));
	/*scene = RMUnion2(
		RMTranslate(RMUnion2(spheres1, spheres2), RMZ(3.)),
		RMMaterial(RMPlane(RMXYZ(0., 1., 0.), 0.), RMColor(0xBBBBBB))
	);*/
	scene = RMUnion([
		RMCompositeObject(RMSphere(1.), RMReflect(0xFFFF00, 0.5), RMXYZ(0., 1., 6.)),
		RMCompositeObject(RMSphere(0.5), RMColor(0xFF00FF), RMXYZ(2., 2., 8.)),
		RMCompositeObject(RMSphere(0.5), RMColor(0x00FFFF), RMXYZ(-2., 2., 8.)),
		RMCompositeObject(RMSphere(0.5), RMColor(0x00FF00), RMXYZ(0., 0., 3.)),
		RMCompositeObject(RMSphere(0.5), RMColor(0x0000FF), RMXYZ(2., 0., 3.)),
		RMCompositeObject(RMSphere(0.5), RMColor(0xFF0000), RMXYZ(-2., 0., 3.)),
		RMCompositeObject(RMPlane(RMXYZ(0., 1., 0.), 0.), RMColor(0xBBBBBB), RMXYZ(0., 0., 0.)),
	]);

	/*light = RMPlus(
		RMPlus(
			RMTranslate(RMMaterial(RMLight(0.03), RMColor(0x00AAAA)), RMXYZ(-2., 8., 3.)),
			RMTranslate(RMMaterial(RMLight(0.05), RMColor(0xAA00AA)), RMXYZ(0., 8., 6.))
		),
		RMTranslate(RMMaterial(RMLight(0.07), RMColor(0xAAAA00)), RMXYZ(2., 8., 3.))
	);*/
	light = RMTranslate(RMMaterial(RMLight(0.05), RMColor(0xFFFFFF)), RMXYZ(100., 100., 100.));
	
	camera = RMCamera(RMXYZ(6., 8., 6.), RMXYZ(0., 0., 6.));

	mrender(
		makeMaterialManager([]), true,
		MSplitter(
			MRaymarchingSidePanel(scene, light, camera),
			MRaymarching(scene, light, camera),
			MFillXY(),
			[MSplitterValue(make(0.25))]
		)
	)
}
